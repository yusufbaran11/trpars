name: TRPars 26.0 Beta - Manual Build

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
    - uses: actions/checkout@v4

    - name: Sistem paketlerini yÃ¼kle
      run: |
        sudo apt-get update
        sudo apt-get install -y debootstrap squashfs-tools xorriso grub-pc-bin grub-efi-amd64-bin mtools dosfstools git

    - name: YapÄ± dizinlerini oluÅŸtur
      run: |
        mkdir -p build/chroot
        mkdir -p build/iso/boot/grub
        mkdir -p build/iso/boot/efi
        mkdir -p build/iso/live
        mkdir -p output

    - name: Debian 13.2 rootfs oluÅŸtur
      run: |
        sudo debootstrap --arch amd64 --variant=minbase trixie build/chroot http://deb.debian.org/debian

    - name: Ã‡ekirdek ve bootloader kur
      run: |
        sudo chroot build/chroot apt-get update
        sudo chroot build/chroot apt-get install -y linux-image-amd64 linux-headers-amd64 grub-pc-bin grub-efi-amd64-bin efibootmgr

    - name: MasaÃ¼stÃ¼ ortamÄ±nÄ± kur (Cinnamon)
      run: |
        sudo chroot build/chroot apt-get install -y cinnamon cinnamon-session lightdm lightdm-gtk-greeter lightdm-gtk-greeter-settings xserver-xorg xserver-xorg-input-all xserver-xorg-video-all

    - name: Temel uygulamalarÄ± kur
      run: |
        sudo chroot build/chroot apt-get install -y chromium thunderbird libreoffice vlc gimp audacity gedit nautilus gdebi synaptic gparted htop curl wget git fonts-liberation fonts-dejavu fonts-noto locales

    - name: Cinnamon eklentileri kur
      run: |
        sudo chroot build/chroot apt-get install -y cinnamon-screensaver cinnamon-desktop-environment cinnamon-control-center cinnamon-settings-daemon

    - name: TÃ¼rkÃ§e locale yapÄ±landÄ±rmasÄ±
      run: |
        sudo chroot build/chroot sed -i 's/^# tr_TR.UTF-8/tr_TR.UTF-8/' /etc/locale.gen
        sudo chroot build/chroot locale-gen tr_TR.UTF-8
        sudo chroot build/chroot update-locale LANG=tr_TR.UTF-8

    - name: VarsayÄ±lan kullanÄ±cÄ± oluÅŸtur
      run: |
        sudo chroot build/chroot useradd -m -s /bin/bash trpars
        sudo chroot build/chroot usermod -aG sudo trpars
        echo "trpars:trpars" | sudo chroot build/chroot chpasswd

    - name: Bilgisayar adÄ± ayarla
      run: |
        echo "trpars" | sudo tee build/chroot/etc/hostname > /dev/null

    - name: Fstab oluÅŸtur
      run: |
        sudo bash -c 'cat > build/chroot/etc/fstab << EOF
/dev/root / ext4 rw,relatime 0 1
tmpfs /tmp tmpfs defaults,nosuid,nodev,noexec,relatime,size=50% 0 0
tmpfs /run tmpfs defaults,nosuid,nodev,mode=755 0 0
EOF'

    - name: GRUB konfigÃ¼rasyonu
      run: |
        sudo bash -c 'cat > build/chroot/etc/default/grub << EOF
GRUB_DEFAULT=0
GRUB_TIMEOUT=5
GRUB_DISTRIBUTOR="TRPars"
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"
GRUB_CMDLINE_LINUX=""
EOF'

    - name: LightDM konfigÃ¼rasyonu
      run: |
        sudo mkdir -p build/chroot/etc/lightdm/lightdm.conf.d
        sudo bash -c 'cat > build/chroot/etc/lightdm/lightdm.conf.d/01_trpars.conf << EOF
[General]
session=cinnamon
autologin-user=trpars
autologin-user-timeout=0
user-session=cinnamon
greeter-session=lightdm-gtk-greeter
EOF'

    - name: Cinnamon ayarlarÄ±
      run: |
        sudo mkdir -p build/chroot/etc/skel/.config/cinnamon
        sudo bash -c 'cat > build/chroot/etc/skel/.config/cinnamon/cinnamon.conf << EOF
[org/cinnamon]
panels-height=['1:30']
panel-edit-mode=false
desktop-effects=true
window-shadows=true
show-hidden-files=false
EOF'

    - name: Sistem temizliÄŸi
      run: |
        sudo chroot build/chroot apt-get autoremove -y
        sudo chroot build/chroot apt-get autoclean -y
        sudo chroot build/chroot apt-get clean -y
        sudo find build/chroot/var/log -type f -name "*.log" -delete
        sudo find build/chroot/tmp -type f -delete

    - name: Squashfs imajÄ± oluÅŸtur
      run: |
        sudo mksquashfs build/chroot build/iso/live/filesystem.squashfs -comp xz -e boot

    - name: Boot imajlarÄ±nÄ± kopyala
      run: |
        sudo cp build/chroot/boot/vmlinuz-* build/iso/boot/vmlinuz 2>/dev/null || true
        sudo cp build/chroot/boot/initrd.img-* build/iso/boot/initrd.img 2>/dev/null || true
        sudo chown -R $USER:$USER build/iso/

    - name: GRUB yapÄ±landÄ±rmasÄ±
      run: |
        bash -c 'cat > build/iso/boot/grub/grub.cfg << EOF
set default=0
set timeout=5
menuentry "TRPars 26.0 Beta (Live)" {
  linux /boot/vmlinuz boot=live live-media-path=/live
  initrd /boot/initrd.img
}
EOF'

    - name: ISO oluÅŸtur
      run: |
        xorriso -as mkisofs \
          -iso-level 3 \
          -c boot.cat \
          -b boot/grub/grub.cfg \
          -no-emul-boot \
          -boot-load-size 4 \
          -boot-info-table \
          -output output/TRPars-26.0-Beta-amd64.iso \
          build/iso/

    - name: SHA256 checksum oluÅŸtur
      run: |
        cd output && sha256sum TRPars-26.0-Beta-amd64.iso > TRPars-26.0-Beta-amd64.iso.sha256 && cat TRPars-26.0-Beta-amd64.iso.sha256

    - name: Bilgi dosyasÄ± oluÅŸtur
      run: |
        cat > output/README.txt << 'EOF'
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         TRPars 26.0 Beta - Linux DaÄŸÄ±tÄ±mÄ±               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ðŸ“‹ DÃ–ÄžITim Bilgileri
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ AdÄ±: TRPars
â€¢ SÃ¼rÃ¼m: 26.0 Beta
â€¢ Temel: Debian 13.2 (Trixie)
â€¢ MasaÃ¼stÃ¼: Cinnamon
â€¢ Dil: TÃ¼rkÃ§e

ðŸŽ¯ AMAÃ‡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Linux'a yeni geÃ§enlere kolaylÄ±k ve kullanÄ±cÄ± dostu deneyim

ðŸ’» SÄ°STEM GEREKSÄ°NÄ°MLERÄ°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ RAM: En az 2 GB
â€¢ Disk: 20 GB (kurulum iÃ§in)
â€¢ Boot: BIOS/UEFI
â€¢ Ä°ÅŸlemci: x86_64

ðŸ› ï¸ KURULU YAZILIMLAR
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ“ MasaÃ¼stÃ¼: Cinnamon, LightDM
âœ“ Web: Chromium
âœ“ E-posta: Thunderbird
âœ“ Ofis: LibreOffice (Writer, Calc, Impress)
âœ“ Multimedya: VLC, GIMP, Audacity
âœ“ AraÃ§lar: Gparted, Synaptic, GDebi, Htop

ðŸ‘¤ VARSAYILAN KULLANÄ°CÄ°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ KullanÄ±cÄ±: trpars
â€¢ Åžifre: trpars

ðŸš€ KURULUM
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. USB'ye yazÄ±n: sudo dd if=TRPars-26.0-Beta-amd64.iso of=/dev/sdX bs=4M
2. USB'den boot edin
3. CanlÄ± ortamda test edin
4. "Sisteme Kur"'Ä± tÄ±klayÄ±n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EOF

    - name: Artifacts upload
      uses: actions/upload-artifact@v4
      with:
        name: TRPars-26.0-Beta
        path: output/
        retention-days: 90

    - name: Build Ã–zet
      run: |
        echo "âœ… TRPars 26.0 Beta inÅŸasÄ± tamamlandÄ±!"
        echo ""
        echo "ðŸ“ Ã‡Ä±ktÄ± DosyalarÄ±:"
        ls -lh output/
        echo ""
        echo "âœ¨ Artifacts'dan indirilebilir"
