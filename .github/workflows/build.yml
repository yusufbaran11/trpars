name: TRPars 26.0 Beta - Manual Build

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Sistem paketlerini yÃ¼kle
      run: |
        sudo apt-get update
        sudo apt-get install -y \
          debootstrap \
          squashfs-tools \
          xorriso \
          grub-pc-bin \
          grub-efi-amd64-bin \
          mtools \
          dosfstools \
          git
    
    - name: YapÄ± dizinlerini oluÅŸtur
      run: |
        mkdir -p build/chroot
        mkdir -p build/iso
        mkdir -p build/iso/boot/grub
        mkdir -p build/iso/boot/efi
        mkdir -p output
    
    - name: Debian 13.2 rootfs oluÅŸtur
      run: |
        sudo debootstrap \
          --arch amd64 \
          --variant=minbase \
          trixie \
          build/chroot \
          http://deb.debian.org/debian
    
    - name: Ã‡ekirdek ve bootloader kur
      run: |
        sudo chroot build/chroot apt-get update
        sudo chroot build/chroot apt-get install -y \
          linux-image-amd64 \
          linux-headers-amd64 \
          grub-pc-bin \
          grub-efi-amd64-bin \
          efibootmgr
    
    - name: MasaÃ¼stÃ¼ ortamÄ±nÄ± kur (Cinnamon)
      run: |
        sudo chroot build/chroot apt-get install -y \
          cinnamon \
          cinnamon-l10n \
          cinnamon-session \
          lightdm \
          lightdm-gtk-greeter \
          lightdm-gtk-greeter-settings \
          xserver-xorg \
          xserver-xorg-input-all \
          xserver-xorg-video-all
    
    - name: Temel uygulama ve araÃ§larÄ± kur
      run: |
        sudo chroot build/chroot apt-get install -y \
          firefox \
          thunderbird \
          libreoffice \
          vlc \
          gimp \
          blender \
          audacity \
          gedit \
          nautilus \
          gdebi \
          synaptic \
          gparted \
          htop \
          neofetch \
          --no-install-recommends
    
    - name: Cinnamon eklentileri kur
      run: |
        sudo chroot build/chroot apt-get install -y \
          cinnamon-screensaver \
          cinnamon-desktop-environment \
          cinnamon-control-center \
          cinnamon-settings-daemon
    
    - name: TÃ¼rkÃ§e dil desteÄŸi ekle
      run: |
        sudo chroot build/chroot apt-get install -y \
          language-pack-tr \
          language-pack-gnome-tr \
          fonts-liberation \
          fonts-dejavu \
          fonts-noto \
          hunspell-tr \
          mythes-tr
    
    - name: Cinnamon Ã¶n ayarlarÄ±nÄ± yapÄ±landÄ±r
      run: |
        sudo mkdir -p build/chroot/etc/skel/.config/cinnamon
        sudo tee build/chroot/etc/skel/.config/cinnamon/cinnamon.conf > /dev/null << 'EOF'
        [org/cinnamon]
        panels-height=['1:30']
        panel-zone-icon-sizes='[{"panelId":1,"left":24,"center":24,"right":16}]'
        enabled-applets=['panel1:left:0:menu@cinnamon.org:0','panel1:left:1:show-desktop@cinnamon.org:1','panel1:left:2:window-list@cinnamon.org:2','panel1:right:0:systray@cinnamon.org:3','panel1:right:1:xapp-status-applet@cinnamon.org:4','panel1:right:2:notifications@cinnamon.org:5','panel1:right:3:printers@cinnamon.org:6','panel1:right:4:keyboard@cinnamon.org:7','panel1:right:5:sound@cinnamon.org:8','panel1:right:6:power@cinnamon.org:9']
        panel-edit-mode=false
        desktop-effects=true
        desktop-effects-blur-brightness=0
        desktop-effects-workspace-switcher-wiggle=true
        window-shadows=true
        enable-vint=true
        show-hidden-files=false
        EOF
    
    - name: LightDM yapÄ±landÄ±rmasÄ±
      run: |
        sudo tee build/chroot/etc/lightdm/lightdm.conf.d/01_trpars.conf > /dev/null << 'EOF'
        [General]
        session=cinnamon
        autologin-user=trpars
        autologin-user-timeout=0
        user-session=cinnamon
        greeter-session=lightdm-gtk-greeter
        EOF
    
    - name: VarsayÄ±lan kullanÄ±cÄ± oluÅŸtur
      run: |
        sudo chroot build/chroot useradd -m -s /bin/bash trpars
        sudo chroot build/chroot usermod -aG sudo trpars
        echo "trpars:trpars" | sudo chroot build/chroot chpasswd
    
    - name: Bilgisayar adÄ±nÄ± ayarla
      run: |
        echo "trpars" | sudo tee build/chroot/etc/hostname
    
    - name: Fstab oluÅŸtur
      run: |
        sudo tee build/chroot/etc/fstab > /dev/null << 'EOF'
        /dev/root / ext4 rw,relatime 0 1
        tmpfs /tmp tmpfs defaults,nosuid,nodev,noexec,relatime,size=50% 0 0
        tmpfs /run tmpfs defaults,nosuid,nodev,mode=755 0 0
        EOF
    
    - name: GRUB bootloader'Ä± yapÄ±landÄ±r
      run: |
        sudo tee build/chroot/etc/default/grub > /dev/null << 'EOF'
        GRUB_DEFAULT=0
        GRUB_TIMEOUT=5
        GRUB_DISTRIBUTOR="TRPars"
        GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"
        GRUB_CMDLINE_LINUX=""
        EOF
    
    - name: Ä°zinleri dÃ¼zelt ve temizle
      run: |
        sudo chroot build/chroot apt-get install -f -y
        sudo chroot build/chroot apt-get autoremove -y
        sudo chroot build/chroot apt-get autoclean -y
        sudo chroot build/chroot apt-get clean -y
        sudo find build/chroot/var/log -type f -name "*.log" -exec sudo rm {} \;
        sudo find build/chroot/tmp -type f -delete
    
    - name: Squashfs imajÄ±nÄ± oluÅŸtur
      run: |
        sudo mksquashfs build/chroot build/iso/live/filesystem.squashfs \
          -comp xz \
          -e boot
    
    - name: Boot imajlarÄ±nÄ± kopyala
      run: |
        sudo cp build/chroot/boot/vmlinuz-* build/iso/boot/vmlinuz
        sudo cp build/chroot/boot/initrd.img-* build/iso/boot/initrd.img
        sudo chown -R $USER:$USER build/iso/
    
    - name: GRUB BIOS konfigÃ¼rasyonu
      run: |
        tee build/iso/boot/grub/grub.cfg > /dev/null << 'EOF'
        set default=0
        set timeout=5
        menuentry "TRPars 26.0 Beta (Live)" {
          echo "TRPars 26.0 Beta baÅŸlatÄ±lÄ±yor..."
          linux /boot/vmlinuz boot=live live-media-path=/live persistence
          initrd /boot/initrd.img
        }
        menuentry "Bellek test et (Memtest86+)" {
          echo "Bellek test ediliyor..."
          linux /boot/memtest86+.bin
        }
        EOF
    
    - name: ISO imajÄ±nÄ± oluÅŸtur
      run: |
        xorriso -as mkisofs \
          -iso-level 3 \
          -isohybrid-mbr /usr/lib/ISOLINUX/isohdpfx.bin \
          -c boot.cat \
          -b isolinux/isolinux.bin \
          -no-emul-boot \
          -boot-load-size 4 \
          -boot-info-table \
          -eltorito-alt-boot \
          -e boot/efiboot.img \
          -no-emul-boot \
          -isohybrid-gpt-basdat \
          -output output/TRPars-26.0-Beta-amd64.iso \
          build/iso/
    
    - name: SHA256 checksum oluÅŸtur
      run: |
        cd output && sha256sum TRPars-26.0-Beta-amd64.iso > TRPars-26.0-Beta-amd64.iso.sha256
    
    - name: Bilgi dosyasÄ± oluÅŸtur
      run: |
        cat > output/TRPars-26.0-Beta-INFO.txt << 'EOF'
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘           TRPars 26.0 Beta - Linux DaÄŸÄ±tÄ±mÄ±              â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        ðŸ“‹ DaÄŸÄ±tÄ±m Bilgileri:
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        â€¢ AdÄ±: TRPars
        â€¢ SÃ¼rÃ¼m: 26.0 Beta
        â€¢ Temel: Debian 13.2 (Trixie)
        â€¢ MimarÄ±: 64-bit (amd64)
        â€¢ MasaÃ¼stÃ¼ OrtamÄ±: Cinnamon
        â€¢ Dosya Sistemi: ext4 (ISO'da Squashfs)
        â€¢ Ä°maj Boyutu: ~2.5 GB (ISO), ~800 MB (Squashfs)
        
        ðŸŽ¯ AmaÃ§:
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        Linux'a yeni geÃ§enlere kolaylÄ±k saÄŸlamak ve kullanÄ±cÄ± 
        dostu bir deneyim sunmak.
        
        ðŸ’» Sistem Gereksinimleri:
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        â€¢ Minimum RAM: 2 GB
        â€¢ Minimum Disk: 20 GB (kurulum iÃ§in)
        â€¢ Boot YÃ¶ntemi: BIOS/UEFI
        â€¢ Ä°ÅŸlemci: x86_64 uyumlu
        
        ðŸ› ï¸ YÃ¼klÃ¼ BileÅŸenler:
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        MasaÃ¼stÃ¼ OrtamÄ±:
        âœ“ Cinnamon (Modern, kullanÄ±cÄ± dostu)
        âœ“ LightDM (Hafif giriÅŸ yÃ¶neticisi)
        âœ“ Cinnamon Screensaver
        
        Ofis UygulamalarÄ±:
        âœ“ LibreOffice (Writer, Calc, Impress)
        âœ“ Firefox (Web tarayÄ±cÄ±sÄ±)
        âœ“ Thunderbird (E-posta istemcisi)
        
        Multimedya:
        âœ“ VLC (Video oynatÄ±cÄ±)
        âœ“ GIMP (Resim dÃ¼zenleyici)
        âœ“ Blender (3D modelleme)
        âœ“ Audacity (Ses dÃ¼zenleyici)
        
        Sistem AraÃ§larÄ±:
        âœ“ Gparted (Disk bÃ¶lÃ¼mlendirme)
        âœ“ Synaptic (Paket yÃ¶neticisi)
        âœ“ GDebi (Deb paketi yÃ¼kleyici)
        âœ“ Htop (Sistem izleyici)
        âœ“ Neofetch (Sistem bilgileri)
        
        Dil DesteÄŸi:
        âœ“ TÃ¼rkÃ§e tam dil desteÄŸi
        âœ“ TÃ¼rkÃ§e yazÄ±m denetleyicisi (Hunspell)
        âœ“ Modern fontlar (Liberation, DejaVu, Noto)
        
        ðŸš€ BaÅŸlarken:
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        1. ISO dosyasÄ±nÄ± USB belleÄŸe yazÄ±n:
           Linux: sudo dd if=TRPars-26.0-Beta-amd64.iso of=/dev/sdX bs=4M
           Windows: Etcher veya similar araÃ§ kullanÄ±n
        
        2. BilgisayarÄ± USB'den boot edin
        
        3. CanlÄ± ortamda test edin (login: trpars / pass: trpars)
        
        4. "Sisteme Kur" seÃ§eneÄŸini tÄ±klayarak yÃ¼kleyin
        
        ðŸ‘¤ VarsayÄ±lan KullanÄ±cÄ±:
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        â€¢ KullanÄ±cÄ± AdÄ±: trpars
        â€¢ Åžifre: trpars
        â€¢ (YÃ¼kleme sonrasÄ± deÄŸiÅŸtirebilirsiniz)
        
        ðŸ“š Ek Bilgiler:
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        â€¢ Debian paket yÃ¶neticisini kullanarak ek yazÄ±lÄ±m yÃ¼kleyebilirsiniz
        â€¢ Terminal: Ctrl+Alt+T
        â€¢ Synaptic ile GUI'den paket yÃ¶netebilirsiniz
        â€¢ GÃ¼ncellemeleri dÃ¼zenli olarak kontrol etmeyi unutmayÄ±n
        
        ðŸ› Sorun Bildirme:
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        Herhangi bir sorun bulursanÄ±z, lÃ¼tfen GitHub deposunda 
        issue aÃ§Ä±nÄ±z.
        
        ðŸ“„ Lisans:
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        TRPars, Debian tabanlÄ±dÄ±r ve aynÄ± lisanslar altÄ±nda 
        daÄŸÄ±tÄ±lÄ±r (GPL v2+)
        
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        YapÄ± Tarihi: $(date)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        EOF
    
    - name: Artifacts'Ä± upload et
      uses: actions/upload-artifact@v4
      with:
        name: TRPars-26.0-Beta
        path: output/
        retention-days: 90
    
    - name: Build tamamlandÄ± - Ã–zet
      run: |
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo "âœ… TRPars 26.0 Beta inÅŸasÄ± tamamlandÄ±!"
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
        echo "ðŸ“ Ã‡Ä±ktÄ± DosyalarÄ±:"
        ls -lh output/
        echo ""
        echo "ðŸ“Š Dosya Bilgileri:"
        file output/*
        echo ""
        echo "ðŸ”’ Checksum DoÄŸrulamasÄ±:"
        cat output/*.sha256
        echo ""
        echo "ðŸ’¾ Artifacts baÅŸarÄ±yla kaydedildi!"
        echo "Artifacts sekmesinden indirilebilir."
