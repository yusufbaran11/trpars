name: TRPars 26.0 Beta Build

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Paketler yÃ¼kle
        run: sudo apt-get update && sudo apt-get install -y debootstrap squashfs-tools xorriso isolinux syslinux
      
      - name: Dizinler oluÅŸtur
        run: mkdir -p build/chroot build/iso/boot/grub build/iso/live build/iso/isolinux output
      
      - name: Debian rootfs oluÅŸtur
        run: sudo debootstrap --arch amd64 --variant=minbase trixie build/chroot http://deb.debian.org/debian
      
      - name: Kernel kur
        run: sudo chroot build/chroot apt-get update && sudo chroot build/chroot apt-get install -y linux-image-amd64 grub-pc-bin
      
      - name: Cinnamon kur
        run: sudo chroot build/chroot apt-get install -y cinnamon lightdm lightdm-gtk-greeter xserver-xorg
      
      - name: Uygulamalar kur
        run: sudo chroot build/chroot apt-get install -y chromium thunderbird vlc gedit nautilus gparted synaptic htop curl wget git fonts-liberation fonts-dejavu fonts-noto locales
      
      - name: Locale ayarla
        run: sudo chroot build/chroot sed -i 's/^# tr_TR.UTF-8/tr_TR.UTF-8/' /etc/locale.gen && sudo chroot build/chroot locale-gen tr_TR.UTF-8
      
      - name: KullanÄ±cÄ± oluÅŸtur
        run: sudo chroot build/chroot useradd -m -s /bin/bash trpars && sudo chroot build/chroot usermod -aG sudo trpars && echo "trpars:trpars" | sudo chroot build/chroot chpasswd
      
      - name: Hostname ayarla
        run: echo "trpars" | sudo tee build/chroot/etc/hostname > /dev/null
      
      - name: LightDM config
        run: sudo mkdir -p build/chroot/etc/lightdm/lightdm.conf.d && sudo bash -c 'cat > build/chroot/etc/lightdm/lightdm.conf.d/01_trpars.conf << EOL
[General]
session=cinnamon
autologin-user=trpars
EOL'
      
      - name: Temizle
        run: sudo chroot build/chroot apt-get autoremove -y && sudo chroot build/chroot apt-get autoclean -y && sudo chroot build/chroot apt-get clean -y
      
      - name: Squashfs oluÅŸtur
        run: sudo mksquashfs build/chroot build/iso/live/filesystem.squashfs -comp xz -e boot
      
      - name: Boot dosyalarÄ± kopyala
        run: |
          sudo cp build/chroot/boot/vmlinuz-* build/iso/boot/vmlinuz 2>/dev/null || true
          sudo cp build/chroot/boot/initrd.img-* build/iso/boot/initrd.img 2>/dev/null || true
          sudo chown -R $USER:$USER build/iso/
      
      - name: GRUB konfigÃ¼rasyonu
        run: |
          cat > build/iso/boot/grub/grub.cfg << 'EOF'
          set default=0
          set timeout=10
          menuentry "TRPars 26.0 Beta Live" {
            search --no-floppy --label TRPARS --set root
            echo "YÃ¼kleniyor..."
            linux /boot/vmlinuz boot=live live-media-path=/live noprompt
            initrd /boot/initrd.img
          }
          EOF
      
      - name: ISOLINUX konfigÃ¼rasyonu
        run: |
          cp /usr/lib/ISOLINUX/isolinux.bin build/iso/isolinux/
          cp /usr/lib/syslinux/modules/bios/ldlinux.c32 build/iso/isolinux/ || true
          cat > build/iso/isolinux/isolinux.cfg << 'EOF'
          DEFAULT vesamenu.c32
          TIMEOUT 100
          PROMPT 0
          LABEL TRPars
            MENU LABEL TRPars 26.0 Beta (Live)
            KERNEL /boot/vmlinuz
            APPEND boot=live live-media-path=/live initrd=/boot/initrd.img noprompt
          EOF
      
      - name: ISO oluÅŸtur (BIOS+UEFI)
        run: |
          xorriso -as mkisofs \
            -iso-level 3 \
            -full-iso9660-filenames \
            -volid "TRPARS" \
            -isohybrid-mbr /usr/lib/ISOLINUX/isohdpfx.bin \
            -c isolinux/boot.cat \
            -b isolinux/isolinux.bin \
            -no-emul-boot \
            -boot-load-size 4 \
            -boot-info-table \
            -eltorito-alt-boot \
            -e boot/efiboot.img \
            -no-emul-boot \
            -isohybrid-gpt-basdat \
            -output output/TRPars-26.0-Beta-amd64.iso \
            build/iso/
      
      - name: Checksum oluÅŸtur
        run: cd output && sha256sum TRPars-26.0-Beta-amd64.iso > TRPars-26.0-Beta-amd64.iso.sha256
      
      - name: Info dosyasÄ± oluÅŸtur
        run: |
          cat > output/README.txt << 'EOF'
          â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
          â•‘         TRPars 26.0 Beta - Linux DaÄŸÄ±tÄ±mÄ±                â•‘
          â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          ðŸ“‹ DaÄŸÄ±tÄ±m Bilgileri
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          â€¢ AdÄ±: TRPars
          â€¢ SÃ¼rÃ¼m: 26.0 Beta
          â€¢ Temel: Debian 13.2 (Trixie)
          â€¢ MasaÃ¼stÃ¼: Cinnamon
          â€¢ Dil: TÃ¼rkÃ§e
          
          ðŸŽ¯ AmaÃ§
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          Linux'a yeni geÃ§enlere kolaylÄ±k saÄŸlamak
          
          ðŸ’» Sistem Gereksinimleri
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          â€¢ RAM: En az 2 GB
          â€¢ Disk: 20 GB (kurulum iÃ§in)
          â€¢ Boot: BIOS/UEFI
          
          ðŸ› ï¸ Kurulu YazÄ±lÄ±mlar
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          âœ“ Cinnamon (MasaÃ¼stÃ¼)
          âœ“ Chromium (Web tarayÄ±cÄ±)
          âœ“ Thunderbird (E-posta)
          âœ“ VLC (Video oynatÄ±cÄ±)
          âœ“ Gedit (Metin editÃ¶rÃ¼)
          âœ“ Nautilus (Dosya yÃ¶neticisi)
          âœ“ Gparted (Disk bÃ¶lÃ¼mlendirme)
          âœ“ Synaptic (Paket yÃ¶neticisi)
          
          ðŸ‘¤ VarsayÄ±lan KullanÄ±cÄ±
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          KullanÄ±cÄ±: trpars
          Åžifre: trpars
          
          ðŸš€ Kurulum AdÄ±mlarÄ±
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          1. Etcher veya dd ile USB'ye yazÄ±n:
             sudo dd if=TRPars-26.0-Beta-amd64.iso of=/dev/sdX bs=4M
          
          2. BIOS/UEFI ayarlarÄ±nda boot sÄ±rasÄ±nÄ± deÄŸiÅŸtirin (USB birinci)
          
          3. USB'den boot edin
          
          4. CanlÄ± ortamda test edin
          
          5. "Sisteme Kur" seÃ§eneÄŸini tÄ±klayÄ±n
          
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          EOF
      
      - name: Artifacts upload
        uses: actions/upload-artifact@v4
        with:
          name: TRPars-26.0-Beta
          path: output/
          retention-days: 90
      
      - name: Build TamamlandÄ±
        run: |
          echo "âœ… TRPars 26.0 Beta Build BaÅŸarÄ±lÄ±!"
          echo ""
          echo "ðŸ“ Dosyalar:"
          ls -lh output/
          echo ""
          echo "ðŸ’¾ Artifacts'tan indirin"
